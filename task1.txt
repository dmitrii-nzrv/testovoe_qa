ID: 01 Название: Успешная оплата без 3-D Secure

Предусловия: 
- Пользователь авторизован 
- В корзине есть товар 
- Используется карта без 3-D Secure 
- Платёжный шлюз доступен

Шаги: 
1. Открыть страницу оформления заказа 
2. Ввести корректные данные карты 
3. Нажать "Оплатить"

Ожидаемый результат: 
- Клиентская валидация проходит успешно 
- Данные отправлены в платёжный шлюз 
- Получен статус “Успешно” 
- Статус заказа обновлён на "Оплачен"
- Пользователю отображается сообщение об успешной оплате 
- На email отправлен чек 

ID: 02 Название: Успешная оплата с 3-D Secure

Предусловия: 
- Пользователь авторизован 
- Используется карта с поддержкой 3-D Secure

Шаги: 
1. Ввести корректные данные карты
2. Нажать "Оплатить"
3. Пройти редирект на страницу 3-D Secure
4. Ввести корректный код подтверждения

Ожидаемый результат: 
- Происходит редирект на 3-D Secure
- После подтверждения получен статус "Успешно"
- Статус заказа = "Оплачен"
- Отображается сообщение об успешной оплате 
- Чек отправлен на email

ID: 03 Название: Отклонение оплаты банком

Предусловия: 
- Используется карта с недостаточным балансом

Шаги: 
1. Ввести данные карты
2. Нажать "Оплатить"

Ожидаемый результат: 
- Получен статус "Отклонено банком"
- Статус заказа = "Не оплачен"
- Пользователю отображается сообщение об отказе 
- Чек не отправляется

ID: 04 Название: Ошибка платёжного сервиса

Предусловия: 
- Платёжный шлюз возвращает ошибку 500 или недоступен

Шаги: 
1. Ввести корректные данные карты 
2. Нажать "Оплатить"

Ожидаемый результат: 
- Отображается сообщение "Ошибка сервиса. Попробуйте позже"
- Статус заказа не меняется на "Оплачен"
- Доступна повторная попытка оплаты 
- Чек не отправляется

ID: 05 Название: Неверный код 3-D Secure

Предусловия: 
- Карта требует 3-D Secure

Шаги: 
1. Ввести корректные данные карты 
2. Нажать "Оплатить"
3. Ввести неверный код подтверждения

Ожидаемый результат: 
- Платёж отклонён 
- Статус заказа = "Не оплачен"
- Отображается сообщение о неуспешной аутентификации 
- Чек не отправляется

ID: 06 Название: Оплата минимально допустимой суммы

Предусловия: 
- Минимальная сумма заказа = X

Шаги: 
1. Оформить заказ на сумму X 
2. Оплатить корректной картой

Ожидаемый результат: 
- Платёж проходит успешно 
- Статус заказа = "Оплачен"

ID: 07 Название: Оплата суммы ниже минимальной

Предусловия: 
- Минимальная сумма заказа = X

Шаги: 
1. Оформить заказ на сумму X - 0.01 
2. Попытаться оплатить

Ожидаемый результат: 
- Отображается ошибка о недопустимой сумме 
- Платёж не отправляется в шлюз

ID: 08 Название: Граничное значение номера карты 16 цифр

Шаги: 
1. Ввести номер карты из 16 цифр 
2. Заполнить остальные поля корректно 
3. Нажать "Оплатить"

Ожидаемый результат: 
- Валидация проходит успешно 
- Данные отправляются в шлюз

ID: 09 Название: Некорректная длина номера карты

Шаги: 
1. Ввести номер карты из 15 или 17 цифр 
2. Нажать "Оплатить"

Ожидаемый результат: 
- Отображается ошибка валидации 
- Данные не отправляются в шлюз

ID: 10 Название: Пустые обязательные поля

Шаги: 
1. Оставить поля карты пустыми 
2. Нажать "Оплатить"

Ожидаемый результат: 
- Отображаются ошибки обязательных полей 
- Запрос в шлюз не отправляется

ID: 11 Название: Неверный формат срока действия

Шаги: 
1. Ввести месяц больше 12 
2. Ввести прошедший год 
3. Нажать "Оплатить"

Ожидаемый результат: 
- Отображается ошибка формата срока действия 
- Запрос не отправляется

ID: 12 Название: Некорректный CVV

Шаги: 
1. Ввести CVV из 2 цифр 
2. Нажать "Оплатить"

Ожидаемый результат: 
- Отображается ошибка валидации CVV 
- Данные не отправляются в шлюз

ID: 13 Название: Проверка корректности отправки данных в шлюз

Предусловия: 
- Включено логирование или используется mock-сервер

Шаги: 
1. Ввести валидные данные 
2. Нажать "Оплатить"
3. Проверить отправленный запрос

Ожидаемый результат: 
- В запросе переданы корректные параметры ID заказа, сумма, валюта 
- Передача данных осуществляется по HTTPS 
- Данные карты передаются в токенизированном виде

ID: 14 Название: Идемпотентность при повторном callback

Предусловия: 
- Смоделирован повторный webhook от шлюза

Шаги: 
1. Отправить повторный callback с тем же статусом оплаты

Ожидаемый результат: 
- Повторная запись оплаты не создаётся 
- Статус заказа не изменяется повторно

ID: 15 Название: Таймаут ответа от платёжного шлюза

Предусловия: 
- Эмулирован таймаут ответа

Шаги: 
1. Нажать "Оплатить"
2. Дождаться истечения времени ожидания

Ожидаемый результат: 
- Пользователь видит сообщение об ошибке 
- Статус заказа не меняется на "Оплачен"
- Доступна повторная попытка оплаты
